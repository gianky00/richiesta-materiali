# Automazione RDA e GUI

Questo progetto gestisce l'automazione delle Richieste di Acquisto (RDA) e fornisce un'interfaccia per visualizzarle.

## Struttura
Il progetto è stato rifattorizzato per migliorare la manutenibilità:

- `main_bot.py`: Script principale di automazione. Scansiona Outlook, processa PDF, aggiorna Excel e sincronizza il Database.
- `main_gui.py`: Nuova interfaccia grafica per gli utenti. Permette di cercare RDA e aprire i PDF allegati.
- `src/`: Cartella contenente il codice sorgente modulare.
- `src/config.py`: File di configurazione. Modificare qui i percorsi e le impostazioni email.

## Installazione Requisiti
Eseguire il comando:
```bash
pip install -r requirements.txt
```
(Se non presente, creare un file requirements.txt con: `pywin32`, `pdfplumber`, `openpyxl`).

## Istruzioni per l'Uso

### 1. Bot di Automazione (`main_bot.py`)
Questo script deve essere eseguito periodicamente (es. tramite Utilità di Pianificazione di Windows) su una macchina che ha accesso a:
- Outlook (configurato con l'account corretto)
- Percorsi di rete (`\\192.168.11.251\...`)

Esecuzione manuale:
```bash
python main_bot.py
```

### 2. Interfaccia Utente (`main_gui.py`)
Gli utenti possono lanciare questo script per consultare l'archivio.
Funzionalità:
- Visualizzazione tabella RDA.
- Filtro rapido (cerca in tutti i campi).
- **Tasto Destro -> Apri PDF**: Apre il file PDF originale archiviato.

Esecuzione:
```bash
python main_gui.py
```

## Note Tecniche
- Il database `database_RDA.db` viene rigenerato completamente ogni volta che `main_bot.py` termina l'esecuzione, copiando fedelmente i dati dal file Excel Master.
- Se il file Excel è aperto da un utente in modalità esclusiva, il Bot potrebbe fallire l'aggiornamento. Assicurarsi che il file Excel sia chiuso durante l'esecuzione del Bot.
